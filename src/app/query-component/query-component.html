<div class="flex flex-col bg-gray-200 w-full h-full p-5">
  <div class="p-3">
    <h1 class="text-2xl font-semibold">Query Conditions</h1>
  </div>
  @for (query of store.queries(); track $index) {
  <div class="flex flex-row justify-between py-2 mx-2">
    @if (!store.isFirstStatement($index)) {
    <div class="text-center self-center ml-2">AND</div>
    }
    <select 
      class="bg-gray-100 rounded-sm p-1 max-w-30"
      [ngClass]="{'w-20': !store.isFirstStatement($index)}"
      [(ngModel)]="query.field">
      @for (option of store.currentFields(); track $index) {
      <option [value]="option.path">{{option.label}}</option>
      }
    </select>
    <select class="bg-gray-100 rounded-sm p-1" [(ngModel)]="query.condition">
      @for (option of store.conditionOptions(); track $index) {
      <option [value]="store.conditions()[option]">{{option}}</option>
      }
    </select>
    <input 
      type="text"
      placeholder="{{store.getValuePlaceholder(query)}}"
      [(ngModel)]="query.value"
      class="w-3/5 bg-gray-100 rounded-sm p-1"/>
    @if (store.queries().length >1) {
    <button class="text-red-700 hover:cursor-pointer hover:bg-white rounded-lg" (click)="store.removeStatement($index)">
      <img src="delete.svg" class="" />
    </button>
    }
  </div>
  }
  <button class="m-2 p-1 rounded-md bg-gray-100 w-1/5" (click)="store.addStatement()">
    + Add Condition
  </button>
  <button class="p-3 bg-blue-500 text-lg text-white self-end rounded-sm drop-shadow-lg hover:cursor-pointer"
    (click)="store.runClicked()">
    Run Query
  </button>

  @if (store.error()) {
  <div class="flex justify-center items-center text-lg text-gray-600 bg-gray-300 rounded-lg m-10">
    Error:
    <div class="text-red-500 text-lg p-2">
      {{store.error()}} 
    </div>
  </div>
  }
</div>